# tmux の使い方

このリポジトリの `tmux/tmux.conf` に基づくキーバインドと操作方法。
プレフィックスキーはデフォルトの `Ctrl-b` から **`Ctrl-z`** に変更済み。

以下、`PREFIX` = `Ctrl-z` と表記する。

## 基本概念

tmux には3つの階層がある：

```
セッション (session)
  └── ウィンドウ (window)  ← ターミナルのタブに相当
        └── ペイン (pane)  ← ウィンドウ内の分割領域
```

## 起動と終了

```bash
# 新しいセッションを開始
tmux

# 名前付きセッションを開始
tmux new -s セッション名

# デタッチ（tmux を裏で動かしたまま抜ける）
PREFIX → d

# セッション一覧を表示してアタッチ
tmux ls
tmux attach -t セッション名

# セッションを終了
exit  # 最後のウィンドウ/ペインで実行
```

## セッション操作

| 操作 | キー |
|------|------|
| セッション一覧 / 切替 | `PREFIX` → `s` |
| セッション一覧から削除 | `PREFIX` → `s` → カーソルで選択 → `x` |
| プロジェクト切替 (ghq + fzf) | `PREFIX` → `f` |
| デタッチ | `PREFIX` → `d` |

### コマンドラインからの操作

```bash
# セッション一覧
tmux ls

# セッションを削除
tmux kill-session -t セッション名

# 全セッションを削除
tmux kill-server
```

## ウィンドウ操作

| 操作 | キー |
|------|------|
| 新規ウィンドウ | `PREFIX` → `c` |
| 次のウィンドウ | `PREFIX` → `n` |
| 前のウィンドウ | `PREFIX` → `p` |
| 番号で切替 | `PREFIX` → `数字` |
| ウィンドウ一覧 | `PREFIX` → `w` |
| ウィンドウ名変更 | `PREFIX` → `,` |
| ウィンドウを閉じる | `PREFIX` → `&` または `exit` |

## ペイン操作

### 分割

| 操作 | キー |
|------|------|
| 横に分割 | `PREFIX` → `\|` |
| 縦に分割 | `PREFIX` → `-` |

### 移動

| 操作 | キー |
|------|------|
| 左のペイン | `PREFIX` → `h` |
| 下のペイン | `PREFIX` → `j` |
| 上のペイン | `PREFIX` → `k` |
| 右のペイン | `PREFIX` → `l` |

### リサイズ

| 操作 | キー |
|------|------|
| 左に広げる | `PREFIX` → `H` |
| 下に広げる | `PREFIX` → `J` |
| 上に広げる | `PREFIX` → `K` |
| 右に広げる | `PREFIX` → `L` |

リサイズキーは `-r` 付きなので、`PREFIX` を押した後に連打できる。

### その他

| 操作 | キー |
|------|------|
| ペインを閉じる | `PREFIX` → `x` |
| ペインの配置を切替 | `PREFIX` → `Space` |
| ペインを最大化/元に戻す | `PREFIX` → `z` |

## コピーモード（vi キーバインド）

スクロールバックバッファは 50,000 行。

| 操作 | キー |
|------|------|
| コピーモード開始 | `PREFIX` → `[` |
| 選択開始 | `v` |
| コピー（クリップボードに送る） | `y` |
| コピーモード終了 | `q` |

マウスでのスクロールやドラッグ選択も有効。

## セッション永続化 (TPM プラグイン)

tmux を終了・PC を再起動しても、セッションの状態を保存・復元できる。

### 初回セットアップ

tmux 内で `PREFIX` → `I`（大文字の I）を押してプラグインをインストールする。

### 操作

| 操作 | キー |
|------|------|
| プラグインインストール | `PREFIX` → `I` |
| セッション保存 | `PREFIX` → `Ctrl-s` |
| セッション復元 | `PREFIX` → `Ctrl-r` |

自動保存が15分間隔で動くので、通常は手動保存不要。
tmux 起動時にはセッションが自動復元される。

## その他

| 操作 | キー |
|------|------|
| 設定リロード | `PREFIX` → `r` |
| コマンドプロンプト | `PREFIX` → `:` |

## ステータスバー

画面上部に表示。左側にセッション名・ウィンドウ番号・ペイン番号、右側に日時を表示。
